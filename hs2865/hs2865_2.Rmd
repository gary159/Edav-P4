---
title: "agent_2"
author: "Hiroaki Suzuki (hs2865)"
date: "2016年4月7日"
output: html_document
---


```{r, echo=FALSE, warning=FALSE, message=FALSE, fig.width=7, fig.align='center'}
library(choroplethr)
library(choroplethrZip)
# how to use and install choroplethrZip
# https://rstudio-pubs-static.s3.amazonaws.com/73396_8172d0d6affb407b9c3ee34fff60f89c.html
# library(devtools)
# install_github('arilamstein/choroplethrZip@v1.5.0')

# library(googleVis)
data(df_pop_zip)
# op <- options(gvis.plot.tag="chart")

# agency_nov = read.csv("november.csv", as.is = TRUE)
# agency_nov_f = data.frame(agency_nov)
# save(agency_nov_f, file="agency_nov_f.Rda")
# load("agency_nov_f.Rda")

# zip_list = unique(agency_nov_f$Incident.Zip)

# zip_list = zip_list[str_length(zip_list)==5]
# zip_list = zip_list[is.na(zip_list) == FALSE]

# zip_count <- matrix(0, ncol=length(zip_list), nrow=1)
# colnames(zip_count) <- zip_list

# for (i in 1:length(zip_list)) {
#   zip_count[1, zip_list[i]] = dim(agency_nov_f[agency_nov_f$Incident.Zip == zip_list[i], ])[1]
# }

# requests_per_zip = data.frame(region = colnames(zip_count), value = zip_count[,colnames(zip_count)])
# requests_per_zip$region <- as.factor(requests_per_zip$region)
# save(requests_per_zip, file="requests_per_zip.Rda")
load("requests_per_zip.Rda")

nyc_fips = c(36005, 36047, 36061, 36081, 36085)
zip_choropleth(requests_per_zip, county_zoom=nyc_fips,
               title="", legend="Numbers of claims at each area on November")


# unique(agency_nov_f$Agency)
# unique(agency_nov_f$Complaint.Type)

# AgencyComplaintCount <- count(agency_nov_f, c('Agency','Complaint.Type'))
# AgencyComplaintCountExtract = AgencyComplaintCount[AgencyComplaintCount$freq > 1000, ]
# AgencyComplaintRelation <- gvisSankey(AgencyComplaintCountExtract, from="Agency", to="Complaint.Type")
# plot(AgencyComplaintRelation)
# 
# 
# AgencyCityCount <- count(agency_nov_f, c('Agency','City'))
# AgencyComplaintCountExtract = AgencyComplaintCount[AgencyComplaintCount$freq > 1000, ]
# AgencyComplaintRelation <- gvisSankey(AgencyComplaintCountExtract, from="Agency", to="Complaint.Type")
# plot(AgencyComplaintRelation)

```
