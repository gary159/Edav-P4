<!--
Required copyright information for w3c_slidy:

   Copyright (c) 2005-2013 W3C (MIT, ERCIM, Keio), All Rights Reserved.
   W3C liability, trademark, document use and software licensing
   rules apply, see:

   http://www.w3.org/Consortium/Legal/copyright-documents
   http://www.w3.org/Consortium/Legal/copyright-software

   Defines single name "w3c_slidy" in global namespace
   Adds event handlers without trampling on any others

-->

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en-US" xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="font-size-adjustment" content="-2" />
<link rel="stylesheet" href="slidy.css" type="text/css" />
<link rel="stylesheet" href="w3c-blue.css" type="text/css" />
<script src="slidy.js" charset="utf-8" type="text/javascript">
</script>
</head>
<body>
<div class="background"></a></object></div>
<div class="background slanty">

</div>
<div class="slide cover title">

<img src="Frozen2.jpg" alt="NYC Subzero"
 class="cover" /><br clear="all" />
<h1>NYC Chaos Day</h1>

<h2>team name</h2><br />
<br />
<br />
<br />
<br /><em>Hit the space bar or swipe left for next slide</em></p>
</div>

<!--            Intro             -->
<div class="slide">
<br/>
<center><font size="6" color ='#ffffff'> Introduction </font></center>
<br />
<br />
<br />

<div class="container">

<p style="font-size:40px">
Analyzing the <b>worst</b> day </p> </br>

<div align="center"> 
<p style="font-size:60px">
New York </p> </br>
</div>

<font size="12">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;
has experienced </font> </br> </br>

<font size="6">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;
in the past few years </font> </br> </br>
<div align = "right">
<font size="6">
in terms of 311 complains</font>
</div>
</div>
</div>


<!--            Identification             -->
<div class="slide">
<br/>
<center><font size="6" color ='#ffffff'> Identification of “Chaos Day”
 </font></center>
<br />
<br />
<br />
</div>



<!--            Exploration             -->
<div class="slide">
<br/>
<center><font size="6" color ='#ffffff'> Exploring Complaints </font></center>
<br />
<br />
<br />
<p>We continue our investigation by plotting the top ten 311 complaint categories for January 8th according to census tracts as shown below. </p>
<iframe src="https://patrick-rogan.shinyapps.io/shiny/" width="100%" height="800px" frameborder="0"></iframe>
<br />
<br />
<p>We see that the complaint categories have different distributions throughout New York city. For example, heat and hot water complaints appear to be clustered around the northern edge of Manhattan, in the lower Bronx and around the center of Brooklyn. However, other categories such as unsanitary condition appear to be uniformly distributed throughout the city. </p>
</div>

<!--            Car Collisions             -->
<div class="slide">
<br/>
<center><font size="6" color ='#ffffff'> Collisions Placeholder </font></center>
<br />
<br />
<br />

</div>


<!--            Historical Car Collisions             -->
<div class="slide">
<br/>
<center><font size="6" color ='#ffffff'> Comparison to historcal collisions in NYC  </font></center>
<br />
<br />
<br />

  <span style="float:left;width: 35%;">
  <IMG SRC="figs/Car_Histogram.png" float = "left" ALT="image">
  </span>
  
  <span style="float:right;width: 50%;">
  <IMG SRC="figs/Car_Violin_Bur.png" float = "right" ALT="image">
  </span>
</div>

<!--            Agency             -->
<div class="slide">
<br/>
<center><font size="6" color ='#ffffff'> Relationship Between Agencies, Complaints, and Boroughs </font></center>
<br/>
<br/>
<br/>
The 311 Service Requests contain many subfields including agencies and boroughs. Here we focus on relationship between agencies, boroughs, and complaints. We use Saneky diagrams to show the relationships between these variables. To put January 8th in perspective, we compare both the anomaly day and the complaints from an entire year. 

```{r, echo=FALSE, warning=FALSE, message=FALSE}

## Preparation for sankey diagram and work cloud
if (!require("googleVis")) {
  install.packages(c("devtools","RJSONIO", "knitr", "shiny", "httpuv"))
  library(devtools)
  install_github("mages/googleVis")
}
if (!require("wordcloud")) {
  install.packages("wordcloud")
}

library(wordcloud)
library(googleVis)
op <- options(gvis.plot.tag="chart")

#### data for sankey diagram
load("sankey_anomal_day.Rda")
load("sankey_2015_top3.Rda")

#### data for word cloud
load("word_anomal_day.Rda")

```
A Sankey diagram of anomaly day is shown below. Here we see the relationship between complaint type and agencies, as well as the relationship between agencies and boroughs. 

<p style="text-align: left; font-size:20px; font-weight:bold;">Sankey diagram between complaints, agencies, and boroughs at anomaly day</p>
<center>
```{r results='asis', tidy=TRUE, echo=FALSE, fig.align='center'}
plot(data_jan_08_output[[1]])
```
</center>
<br />
In the above diagram, there are many complaints directed to HPD (Housing Preservation & Development) on January 8th. Among these, there are 5225 complaints classified as HEAT/HOT WATER which is the largest complaint category for this day. We also see other complaints such as plumbing or DOOR/WINDOW. Furthermore we observe the relationships between agencies and boroughs. For example, the numbers of complaints directed to HPD are the largest in Brooklyn. 

Another Sankey diagram of anomaly day is shown below. In this diagram, we can see the relationship between agencies and boroughs, and the relationship between boroughs and complaints.  

<p style="text-align: left; font-size:20px; font-weight:bold;">Sankey diagram between agencies, boroughs, and complaints at anomaly day</p>
<center>
```{r results='asis', tidy=TRUE, echo=FALSE, fig.align='center'}
plot(data_jan_08_output[[2]])
```
</center>
In the diagram above, we can see the direct relationship between borough and complaint type. We can see that complaints of HEAT/HOT WATER are most prevalent in Brooklyn. From this result, we can also assume that some incidents related to water happened at the anomaly day. 

Sankey diagram of one year is shown below. In this Sankey diagram, we can see the relationship between complaint type and agencies, and the relationship between agencies and boroughs. Here, we picked up top 3 agencies that had largest numbers of complaints at the nomaly day(Jan/8/2015) to compare the result with yearly data and anomaly data. 

<p style="text-align: left; font-size:20px; font-weight:bold;">Sankey diagram between complaints, agencies, and boroughs at 2015</p>
<center>
```{r results='asis', tidy=TRUE, echo=FALSE}
plot(data_2015_2016_TOP3_output[[1]])
```
</center>

At the diagram above, numbers of complaints directed to HPD, DOT or NYPD during 2015 and 2016 can be seen. As we can see above, complaints of HEATING are the largest, however, complaints of HEAT/HOT WATER that was the largest numbers of complaints at anomaly day is not the largest number. Hence, we can say that at the anomaly day, the numbers of complaints of HEAT/HOT WATER was very high compared with anual data. In addition, the numbers of complaints directed to HPD at Brooklyn was the largest (1076902), and it may be possible that houses or buildings at Brooklyn may have some issue related to water or heating.

AS we seen at examples of sankey diagram, HPD had the most complaints. Then, we will look at descriptions written in complaints. 

Here is the description information of complains directed to HPD at the anomaly day (Jan/8/2015).

```{r, echo=FALSE, fig.width = 3, fig.height = 3, fig.align='center'}
dtm = JAN_08_2015_mining_HPD[[1]]
mfreq = colSums(as.matrix(dtm))

set.seed(429) 
wordcloud(names(mfreq),mfreq,
          min.freq=0,
          scale=c(4,0.5),
          colors=brewer.pal(8, "Dark2"),
          random.color=FALSE, 
          random.order=FALSE)
```

As we can see, words that are related to housing such as 'building' and 'apartment' are prevalent. From the previous analysis about complaint type, we know that there are many HEAT/HOT WATER complaints. This wordcloud is consistent with the distribution of complaints for this day.

</div>


<!--            Agency Response Time Analysis             -->
<div class="slide">
<br/>
<center><font size="6" color ='#ffffff'> Agency Response Time Analysis  </font></center>
<br />
<br />
<br />
The top complaints happended on Jan 2015 mostly went into two agencies: HPD and DOT. We'd like to summarize their efficiecny of closing the top complaints that they are in charge of over the month. <br />

Especially, we want to look at the window between Jan 1st and Jan 15th, which is a week before/after the chaos day Jan 8th. And we will focus on the Manhattan borough since most of us lived in this neighborhood. 
<br />
We are curious if there is any pattern within the agency. For example, whether HPD's response time to one type of complaint is affected by the other complaints? How's their efficiecny in closing complaints that were created on the chaos day compared to that on the other days? 
<br />
<br />

```{r, echo=FALSE, warning=FALSE, message=FALSE}
library(plotly)
load("HPD_manhattan.Rda")
load("DOT_manhattan.Rda")
load("HPD_corr.Rda")
load("DOT_corr.Rda")
```

<center>
```{r, echo=FALSE, fig.width=4.5, fig.height=4.5}
par(mfrow=c(1,2))
plot(HPD_corr, main="HPD response time correlation")
plot(DOT_corr, main="DOT response time correlation")
```
</center>
<br />
<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp; The pair correlations between types of complaints are very random for each agency.Then we move on to visualize the volumn of response time by complaint categories for two agencies.
<br />
<br />
<br />
<center>
```{r, echo=FALSE, warning=FALSE, message=FALSE}
### Jan 1st to Jan 15th. 

plot_ly(data = HPD_manhattan[1:75,], x = date, y = response, type='bar',color =complaint)%>%
  layout(title="Average days for HPD to close different complaints (reported in Manhattan)")

```
</center>

HPD is relatively efficient in fixing the Heat/Hot Water complaints, which is necessary because it's more urgent compared to other complaints during the winter days. 

This is also the case for complaints created on Jan 8th. If hover over Jan 8th, you will see that HPD took longer time closing Plumbing, Door/Window, Unsanitary Condition, Paint/Plaster issues than closing Heat/Hot Water complaint. 
<br />
<br />
<center>
```{r, echo=FALSE, warning=FALSE, message=FALSE}
plot_ly(data = DOT_manhattan[1:75,], x = date, y = response, type='bar', color =complaint)%>%
  layout(title="Average days for DOT to close different complaints (reported in Manhattan)")
````
</center>

DOT's response efficiency differs among types of complaints as well, while the contrast is more obvious. Highway Condition and Traffic Signal Condition are definitely more urgent than other cases and so they might be the priority things for DOT to work on. 
<br />
<br />

From the visualization, we hardly found a pattern that could summarize the agency's response time to different complaints over the week before/after Jan 8th, which is understandable as the urgency of complaints and other extragenous factors may affect the agency's efficiency.
<br />
<br />
<br />
<br />

</div>

<div class="slide">
<br/>
<center><font size="6" color ='#ffffff'> References </font></center>
<br />
<br />
<br />
<p>
<b>311 | City of New York </b><br>
http://www1.nyc.gov/311/<br>
</p>
<br />
</div>

